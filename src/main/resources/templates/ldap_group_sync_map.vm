#disable_html_escaping()
<html>
<head>
    <title>$i18n.getText("jira.ldap.group.sync.maps.option.label")</title>
    <meta name="decorator" content="atl.admin" />
    $webResourceManager.requireResource("com.adsk.jira.ldapgroupsync.plugin.jira-ldap-group-sync-plugin:jira-ldap-group-sync-plugin-resources")
    <meta name="configId" content="$textutils.htmlEncode($action.configId)"/>
    <script>
        AJS.$(document).ready(function(){
            if("$configId" != 0) {
                AJS.$("#LdapGroupMapSchedule").stop().slideUp();
                AJS.$("#LdapGroupMapAddEdit").stop().slideDown();
                AJS.$("#LdapGroupMapDel").stop().slideUp();
                AJS.$("#LdapGroupMapAddEditForm input[name='submitted']").val("SAVE");
                location.hash = "#LdapGroupMapAddEdit";
            }
        });
        
        function prepareHide() {
            AJS.$("#LdapGroupMapAddEdit").stop().slideUp();
        }
        
        function prepareDelete(configId) {
            AJS.$("#LdapGroupMapSchedule").stop().slideUp();
            AJS.$("#LdapGroupMapDel").stop().slideDown();
            AJS.$("#LdapGroupMapAddEdit").stop().slideUp();            
            AJS.$("#LdapGroupMapDelForm input[name='configId']").val(configId);
            location.hash = "#LdapGroupMapDel";
        }

        function prepareSchedule() {
            AJS.$("#LdapGroupMapDel").stop().slideUp();
            AJS.$("#LdapGroupMapAddEdit").stop().slideUp();            
            AJS.$("#LdapGroupMapSchedule").stop().slideDown();
            location.hash = "#LdapGroupMapSchedule";
        }
    </script>
</head>
<body>

<p>
<span class="adskldapsync_heading">$i18n.getText("jira.ldap.group.sync.maps.option.label")</span>
<a href="https://github.com/Autodesk/jira-ldap-group-sync-plugin/wiki/Configure-Automatic-Sync" target="_blank"
    class="adskldapsync_question" title="LDAP Group Sync Plugin Documentation"></a>

<a class="adskldapsync_run" href="/secure/LdapGroupSyncRunAction.jspa" title="Run On-demand LDAP and JIRA Group Sync"></a>

<a href="#" class="adskldapsync_schedule" onClick="prepareSchedule()" 
    title="Configure Sync Schedule"></a>
</p>

<!-- options ADD -->

<div id="LdapGroupMapAddEdit">
<form id="LdapGroupMapAddEditForm" class="aui" method="post" action="LdapGroupSyncMapAction.jspa" >
<input type="hidden" id="configId" name="configId" class="text" value="$!configId" />
<div class="field-group">
    <label for="ldap_group">
        $i18n.getText("jira.ldap.group.configure.option.ldap_group.label"):
        <span class="aui-icon icon-required"></span>
    </label>
    <input type="text" id="ldapGroup" name="ldapGroup" class="text long-field" 
        placeholder="Enter distribution email list alias or LDAP security group name" value="$!ldapGroup" />
</div>
<div class="field-group">
    <label for="jira_group">
        $i18n.getText("jira.ldap.group.configure.option.jira_group.label"):
        <span class="aui-icon icon-required"></span>
    </label>
    <input type="text" id="jiraGroup" name="jiraGroup" class="text long-field" 
        placeholder="Your JIRA Group Name" value="$!jiraGroup" />
</div>
<div class="field-group">
    <label for="support">
        $i18n.getText("jira.ldap.group.configure.option.support.label"):
        <span class="aui-icon icon-required"></span>
    </label>
    <select id="support" name="support" class="text">
        #foreach($a in ["true", "false"])
        <option value="$a"
            #if ($a == $support)selected#end
        >$a.toUpperCase()</option>
        #end
    </select>
</div>
<div class="aui-buttons">
    <input class="aui-button aui-button-primary" type="submit" name="submitted" value="ADD" />
</div>
</form>
</div>


<!-- Delete Mapping ID -->
<div id="LdapGroupMapDel" style="display: none;">
<form id="LdapGroupMapDelForm" class="aui" method="post" action="LdapGroupSyncMapAction.jspa" >
<div class="field-group">
    <label for="configId">
        $i18n.getText("jira.ldap.group.configure.option.configId.label"):
        <span class="aui-icon icon-required"></span>
    </label>
    <input type="text" id="configId" name="configId" class="text" />
</div>
<div class="aui-buttons">
    <input class="aui-button aui-button-primary" type="submit" name="submitted" value="DEL" />
</div>
</form>
</div>

<!-- Configure Schedule -->
<div id="LdapGroupMapSchedule" style="display: none;">
<form id="LdapGroupMapScheduleForm" class="aui" method="post" action="LdapGroupSyncMapAction.jspa" >
<div class="field-group">
    <label for="interval">
        $i18n.getText("jira.ldap.group.configure.option.interval.label"):
        <span class="aui-icon icon-required"></span>
    </label>
    <input type="number" id="interval" name="interval" class="text" min="1" value="$!interval" />
</div>
<div class="aui-buttons">
    <input class="aui-button aui-button-primary" type="submit" name="submitted" value="Schedule" />
</div>
</form>
</div>


<!-- config status -->
<p id="LdapGroupSyncStatus" style="background-color:#E0FFFF;">$!status</p>

<p>
<span class="adskldapsyncconfig_count_span">Count &diams; <span id="adskldapsyncconfig_count">$configList.size()</span></span>
<div class="adskldapsyncconfig_search_div">
    <input type="text" id="adskldapsyncconfig_search" placeholder=" Search" onkeyup="adskldapsyncconfig_filter(this)" />
</div>
</p>

<!-- config display -->

<div id="ldapGroupMapDisplay">
<table id="adskldapsync_configs" class="aui">
    <tr><th>Config ID</th><th>LDAP Group Name</th><th>JIRA Group Name</th><th>Active?</th><th></th></tr>
    #foreach ($entry in $configList)
        <tr><td>$entry.configId</td><td>$entry.ldapGroup</td><td>$entry.jiraGroup</td><td>$entry.support</td>
        <td>            
            <a class="adskldapsync_edit" title="Edit Map Configuration" href="#"
                onClick="window.location.href='LdapGroupSyncMapAction.jspa?configId=$entry.configId'"></a>
            <a class="adskldapsync_delete" href="#" title="Delete Config" 
                onClick="prepareDelete('$entry.configId')"></a>
        </td>        
        </tr>
    #end
</table>
</div>


</body>
</html>
